<div class="page-header">
  <h1>Suggestions</h1>
</div>
<br>
<ul class="list-unstyled list-inline">
  <li>
    <%= linkTo(newSuggestionsPath(), {class: "btn btn-primary"}) { %>
    Create New Suggestion
    <% } %>
  </li>
</ul>
<br>

<div class="container">
  <input type="text" id="myInput" onkeyup="search()" placeholder="Search for suggestions..">
  <div id="suggestion-list">
    <%= for (suggestion) in suggestions { %>
    <div class="suggestion-element">
      <h2><%= suggestion.Title %></h2>
      <p><%= suggestion.Body %></p>
      <%= if (suggestion.DevComment) { %>
      <p><%= suggestion.DevComment %></p>
      <% } %>
      <p>Suggested in version <%= suggestion.VersionWhenSuggested %> by <%= suggestion.SuggestedBy%></p>
      <p>Popularity: <%= len(suggestion.UpvotedBy) - len(suggestion.DownvotedBy) %></p>
      <p><%=  %></p>
      <p>
        <div class="pull-right">
          <%= linkTo(suggestionPath({ suggestion_id: suggestion.ID }), {class: "btn btn-info", body: "View"}) %>
          <%= linkTo(editSuggestionPath({ suggestion_id: suggestion.ID }), {class: "btn btn-warning", body: "Edit"}) %>
          <%= if (suggestion.SuggestedBy == current_user.Username) {linkTo(suggestionPath({ suggestion_id: suggestion.ID }), {class: "btn btn-danger", "data-method": "DELETE", "data-confirm": "Are you sure?", body: "Delete"})} %>
        </div>
        </td>
        <br>
    </div>
    <% } %>
  </div>
</div>

<div class="text-center">
  <%= paginator(pagination) %>
</div>

<script>
  console.log("test");
  function search() {
    // Declare variables
    var input, filter, suggestionList, suggestions, suggestionTitle, i, txtValue;
    input = document.getElementById('myInput');
    filter = input.value.toUpperCase();
    suggestionList = document.getElementById('suggestion-list');
    suggestions = suggestionList.getElementsByClassName('suggestion-element');

    // Loop through all list items, and hide those who don't match the search query
    for (i = 0; i < suggestions.length; i++) {
      suggestionTitle = suggestions[i].getElementsByTagName("h2")[0];
      txtValue = suggestionTitle.textContent || suggestionTitle.innerText;
      if (txtValue.toUpperCase().indexOf(filter) > -1) {
        suggestions[i].style.display = "";
      } else {
        suggestions[i].style.display = "none";
      }
    }
  }
</script>